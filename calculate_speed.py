#!/usr/bin/env python3
"""
–ê–Ω–∞–ª–∏–∑ —Å–∫–æ—Ä–æ—Å—Ç–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑ –ª–æ–≥–æ–≤
"""

# –î–∞–Ω–Ω—ã–µ –∏–∑ –ª–æ–≥–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 627-1015)
logs = """
03:25:24,343 - üîÑ –°–æ—Å—Ç–æ—è–Ω–∏–µ: waiting_details
03:25:24,343 - üì¶ –ü–æ–ª—É—á–µ–Ω—ã –¥–µ—Ç–∞–ª–∏, –∏—â—É –∫–Ω–æ–ø–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è...
03:25:27,756 - üîÑ –°–æ—Å—Ç–æ—è–Ω–∏–µ: waiting_details
03:25:27,756 - üì¶ –ü–æ–ª—É—á–µ–Ω—ã –¥–µ—Ç–∞–ª–∏, –∏—â—É –∫–Ω–æ–ø–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è...
03:25:35,773 - üö® –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ù–û–í–´–ï –ü–ï–†–ï–í–û–ó–ö–ò! (#14)
03:25:35,774 - ‚è±Ô∏è  –í—Ä–µ–º—è: 03:25:35.774
03:25:36,601 - üéâ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –ë–†–û–ù–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!
03:25:59,399 - üö® –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ù–û–í–´–ï –ü–ï–†–ï–í–û–ó–ö–ò! (#15)
03:25:59,401 - ‚è±Ô∏è  –í—Ä–µ–º—è: 03:25:59.401
03:26:00,283 - üéâ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –ë–†–û–ù–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!
03:26:23,009 - üö® –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ù–û–í–´–ï –ü–ï–†–ï–í–û–ó–ö–ò! (#16)
03:26:23,010 - ‚è±Ô∏è  –í—Ä–µ–º—è: 03:26:23.010
03:26:23,877 - üéâ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –ë–†–û–ù–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!
03:27:21,789 - üö® –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ù–û–í–´–ï –ü–ï–†–ï–í–û–ó–ö–ò! (#17)
03:27:21,790 - ‚è±Ô∏è  –í—Ä–µ–º—è: 03:27:21.790
03:28:20,611 - üö® –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ù–û–í–´–ï –ü–ï–†–ï–í–û–ó–ö–ò! (#18)
03:28:20,613 - ‚è±Ô∏è  –í—Ä–µ–º—è: 03:28:20.613
03:28:21,428 - üéâ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –ë–†–û–ù–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!
"""

# –ü–∞—Ä—Å–∏–º –ª–æ–≥–∏
import re
from datetime import datetime

def parse_time(time_str):
    """–ü–∞—Ä—Å–∏—Ç –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM:SS.mmm"""
    parts = time_str.split(':')
    h = int(parts[0])
    m = int(parts[1])
    s_ms = parts[2].split('.')
    s = int(s_ms[0])
    ms = int(s_ms[1]) if len(s_ms) > 1 else 0
    return h * 3600 + m * 60 + s + ms / 1000.0

# –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –ø–∞—Ä—ã –Ω–∞—á–∞–ª–æ-–∫–æ–Ω–µ—Ü
starts = {}
ends = {}

for line in logs.strip().split('\n'):
    if '–û–ë–ù–ê–†–£–ñ–ï–ù–´ –ù–û–í–´–ï –ü–ï–†–ï–í–û–ó–ö–ò' in line:
        match = re.search(r'(\d{2}:\d{2}:\d{2},\d{3})', line)
        if match:
            time_str = match.group(1).replace(',', '.')
            num_match = re.search(r'#(\d+)', line)
            if num_match:
                num = int(num_match.group(1))
                starts[num] = parse_time(time_str)
    elif '–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –ë–†–û–ù–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û' in line:
        match = re.search(r'(\d{2}:\d{2}:\d{2},\d{3})', line)
        if match:
            time_str = match.group(1).replace(',', '.')
            # –ù–∞—Ö–æ–¥–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–∞—Ä—Ç –±–µ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            for num in sorted(starts.keys(), reverse=True):
                if num not in ends:
                    ends[num] = parse_time(time_str)
                    break

# –í—ã—á–∏—Å–ª—è–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
durations = []
for num in sorted(starts.keys()):
    if num in ends:
        duration = ends[num] - starts[num]
        durations.append(duration)
        print(f"#{num}: {duration:.3f} —Å–µ–∫")

if durations:
    avg = sum(durations) / len(durations)
    print(f"\n=== –ò–¢–û–ì–û ===")
    print(f"–£—Å–ø–µ—à–Ω—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π: {len(durations)}")
    print(f"–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: {avg:.3f} —Å–µ–∫ ({avg*1000:.0f} –º—Å)")
    print(f"–ú–∏–Ω–∏–º—É–º: {min(durations):.3f} —Å–µ–∫")
    print(f"–ú–∞–∫—Å–∏–º—É–º: {max(durations):.3f} —Å–µ–∫")






